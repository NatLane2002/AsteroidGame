<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Cosmic Cats - A classic arcade-style asteroid shooter game with modern graphics, cat alien bosses, and customization shop">
    <title>Cosmic Cats</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üê±</text></svg>">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-stars"></div>
        <div class="loading-content">
            <div class="loading-rocket">üöÄ</div>
            <h1 class="loading-title"><span>COSMIC CATS</span></h1>
            <div class="loading-bar-container">
                <div class="loading-bar"></div>
            </div>
            <p class="loading-text">LOADING...</p>
        </div>
    </div>

    <div id="game-container">
        <canvas id="gameCanvas"></canvas>
        
        <!-- HUD Overlay - Reorganized Layout -->
        <div id="hud">
            <!-- Top Left: Score + Combo -->
            <div id="top-left-hud">
                <div id="score-container" class="hud-box">
                    <span class="hud-label">SCORE</span>
                    <span id="score" class="hud-value">0</span>
                </div>
                <div id="combo-container" class="hud-box combo-box hidden">
                    <span id="combo-count" class="combo-count">0</span>
                    <span class="combo-label">COMBO</span>
                    <span id="combo-mult" class="combo-mult">x1</span>
                </div>
            </div>

            <!-- Top Right: Lives Only -->
            <div id="top-right-hud">
                <div id="lives-container" class="hud-box">
                    <span class="hud-label">LIVES</span>
                    <div id="lives"></div>
                </div>
            </div>

            <!-- Bottom Left: Coins + Powerups -->
            <div id="bottom-left-hud">
                <div id="coins-container" class="hud-box">
                    <span class="hud-label">COINS</span>
                    <div class="coins-display">
                        <span class="coin-icon">ü™ô</span>
                        <span id="coins" class="hud-value coins-value">0</span>
                    </div>
                </div>
                <div id="powerup-container">
                    <div id="shield-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">üõ°Ô∏è</span>
                        <span class="powerup-name">Shield</span>
                        <div class="powerup-bar"><div id="shield-bar"></div></div>
                    </div>
                    <div id="rapidfire-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">‚ö°</span>
                        <span class="powerup-name">Rapid Fire</span>
                        <div class="powerup-bar"><div id="rapidfire-bar"></div></div>
                    </div>
                    <div id="magnet-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">üß≤</span>
                        <span class="powerup-name">Coin Magnet</span>
                        <div class="powerup-bar"><div id="magnet-bar"></div></div>
                    </div>
                    <div id="timeslow-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">‚è±Ô∏è</span>
                        <span class="powerup-name">Time Slow</span>
                        <div class="powerup-bar"><div id="timeslow-bar"></div></div>
                    </div>
                    <div id="piercing-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">üéØ</span>
                        <span class="powerup-name">Piercing Shot</span>
                        <div class="powerup-bar"><div id="piercing-bar"></div></div>
                    </div>
                    <div id="tripleshot-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">üî±</span>
                        <span class="powerup-name">Triple Shot</span>
                        <div class="powerup-bar"><div id="tripleshot-bar"></div></div>
                    </div>
                    <div id="largebullets-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">üîµ</span>
                        <span class="powerup-name">Large Bullets</span>
                        <div class="powerup-bar"><div id="largebullets-bar"></div></div>
                    </div>
                    <div id="blastradius-indicator" class="powerup-indicator hidden">
                        <span class="powerup-icon">üí•</span>
                        <span class="powerup-name">Blast Radius</span>
                        <div class="powerup-bar"><div id="blastradius-bar"></div></div>
                    </div>
                </div>
            </div>

            <!-- Bottom Right: Level -->
            <div id="bottom-right-hud">
                <div id="level-container" class="hud-box">
                    <span class="hud-label">LEVEL</span>
                    <span id="level" class="hud-value">1</span>
                </div>
            </div>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="overlay">
            <div class="overlay-content start-content">
                <h1 class="game-title">COSMIC<br><span class="accent">CATS</span></h1>
                <div class="title-decoration"></div>
                <p class="subtitle">Navigate through the asteroid field and defeat the Cat Aliens!</p>
                
                <!-- Liberty Easter Egg Tooltip -->
                <div class="liberty-tooltip-container">
                    <div class="liberty-icon" title="Reveal Secret">‚ÑπÔ∏è</div>
                    <div class="liberty-message">
                         <div class="liberty-heading">Secret</div>
                         <div class="liberty-text">Made for Liberty!</div>
                    </div>
                </div>

                <!-- High Score Display -->
                <div class="highscore-display-main">
                    <div class="highscore-trophy">üèÜ</div>
                    <div class="highscore-content">
                        <span class="highscore-label">HIGH SCORE</span>
                        <span class="highscore-value" id="menu-highscore">0</span>
                    </div>
                    <div class="highscore-trophy">üèÜ</div>
                </div>
                
                <div class="menu-buttons">
                    <button id="start-button" class="game-button">
                        <span>START GAME</span>
                        <div class="button-glow"></div>
                    </button>
                    <button id="shop-button" class="game-button secondary">
                        <span>üõí SHOP</span>
                    </button>
                </div>

                <div class="modifiers-section-container">
                    <button id="mods-button" class="modifier-toggle-btn">
                        <span>‚ö° MODIFIERS</span>
                    </button>
                    <div class="modifiers-spacer"></div>
                </div>

                <div class="wallet-display">
                    <span class="wallet-label">Your Coins:</span>
                    <span class="wallet-coins">ü™ô <span id="wallet-coins">0</span></span>
                </div>
                
                <!-- User Account Section -->
                <div class="account-section">
                    <!-- Shown when signed out -->
                    <button id="auth-signin-btn" class="game-button auth-btn" onclick="showAuthModal('signin')">
                        <span>üîê SIGN IN</span>
                    </button>
                    
                    <!-- Shown when signed in -->
                    <div id="user-profile" class="user-profile" style="display: none;">
                        <img id="user-avatar" class="user-avatar" src="" alt="">
                        <div class="user-info">
                            <span class="user-label">Logged in as</span>
                            <span id="user-display-name" class="user-name">Player</span>
                        </div>
                        <button class="signout-btn" onclick="signOut()" title="Sign Out">
                            <span>üö™</span>
                        </button>
                    </div>
                    <div id="sync-indicator" class="sync-indicator" style="display: none;">
                        <span class="sync-icon">‚òÅÔ∏è</span>
                        <span class="sync-text">Synced</span>
                    </div>
                </div>


                <div class="menu-secondary-buttons">
                    <button id="achievements-button" class="icon-button" title="Achievements">
                        <span class="icon-btn-emoji">üèÜ</span>
                        <span class="icon-btn-text">AWARDS</span>
                    </button>
                    <button id="stats-button" class="icon-button" title="View Stats">
                        <span class="icon-btn-emoji">üìä</span>
                        <span class="icon-btn-text">STATS</span>
                    </button>
                    <button id="guide-button" class="icon-button" title="How to Play">
                        <span class="icon-btn-emoji">‚ùì</span>
                        <span class="icon-btn-text">GUIDE</span>
                    </button>
                    <button id="settings-button" class="icon-button" title="Settings">
                        <span class="icon-btn-emoji">‚öôÔ∏è</span>
                        <span class="icon-btn-text">SETTINGS</span>
                    </button>
                    <!-- Fullscreen button removed as requested -->
                </div>
            </div>
        </div>

        <!-- Guide Screen -->
        <div id="guide-screen" class="overlay hidden">
            <div class="overlay-content guide-content">
                <h2 class="overlay-title">HOW TO PLAY</h2>
                <div class="controls-info-large">
                    <div class="control-group">
                        <h3>‚å®Ô∏è KEYBOARD MODE</h3>
                        <p class="control-scheme-desc">Classic arcade controls</p>
                        <div class="control-row"><span class="key">W</span> / <span class="key">‚Üë</span> <span>Thrust Forward</span></div>
                        <div class="control-row"><span class="key">A</span> / <span class="key">‚Üê</span> <span>Rotate Left</span></div>
                        <div class="control-row"><span class="key">D</span> / <span class="key">‚Üí</span> <span>Rotate Right</span></div>
                        <div class="control-row"><span class="key">SPACE</span> <span>Fire</span></div>
                    </div>
                    <div class="control-group">
                        <h3>üéØ MOUSE+KEYS MODE</h3>
                        <p class="control-scheme-desc">WASD movement + mouse aiming</p>
                        <div class="control-row"><span class="key">W</span><span class="key">A</span><span class="key">S</span><span class="key">D</span> <span>Move Ship</span></div>
                        <div class="control-row"><span class="key">MOUSE</span> <span>Aim Direction</span></div>
                        <div class="control-row"><span class="key">LEFT CLICK</span> <span>Fire (hold to auto-fire)</span></div>
                        <p class="control-note">Ship faces cursor, WASD moves independently!</p>
                    </div>
                    <div class="control-group">
                        <h3>üñ±Ô∏è MOUSE ONLY MODE</h3>
                        <p class="control-scheme-desc">Pure mouse control</p>
                        <div class="control-row"><span class="key">MOUSE</span> <span>Aim Direction</span></div>
                        <div class="control-row"><span class="key">LEFT CLICK</span> <span>Fire (hold to auto-fire)</span></div>
                        <div class="control-row"><span class="key">RIGHT CLICK</span> <span>Thrust Forward (hold)</span></div>
                        <p class="control-note">No keyboard needed - aim and thrust with mouse!</p>
                    </div>
                    <div class="control-group">
                        <h3>üì± MOBILE</h3>
                        <p>Use the on-screen Joystick to move and Rotate.</p>
                        <p>Tap the Red Button to Fire.</p>
                    </div>
                </div>
                <p class="settings-hint">Change control scheme in ‚öôÔ∏è Settings</p>
                <button class="game-button secondary back-button" onclick="showOverlay('start-screen'); hideOverlay('guide-screen')">
                    <span>‚Üê BACK TO MENU</span>
                </button>
            </div>
        </div>

        <!-- Achievements Screen -->
        <div id="achievements-screen" class="overlay hidden">
            <div class="overlay-content achievements-content">
                <h2 class="overlay-title">HALL OF FAME</h2>
                <div id="achievements-grid" class="achievements-grid">
                    <!-- Achievements injected here -->
                </div>
                <button class="game-button secondary back-button" onclick="showOverlay('start-screen'); hideOverlay('achievements-screen')">
                    <span>‚Üê BACK TO MENU</span>
                </button>
            </div>
        </div>

        <!-- Modifiers Screen -->
        <div id="modifiers-screen" class="overlay hidden">
            <div class="overlay-content modifiers-content">
                <h2 class="overlay-title">GAME MODIFIERS</h2>
                <p class="modifiers-desc">Stack modifiers for unique gameplay challenges!</p>
                
                <div class="current-modifiers-status">
                    <span>COIN DROP RATE: <strong id="mod-coin-rate">100%</strong></span>
                    <div class="mod-warning hidden" id="mod-score-warning">‚ö†Ô∏è High Scores & Achievements DISABLED</div>
                </div>

                <div class="modifiers-grid">
                    <div class="modifier-card" id="mod-fast">
                        <div class="mod-icon">‚ö°</div>
                        <h3>FAST MODE</h3>
                        <p>Ship moves 2x faster.</p>
                        <button class="mod-toggle" onclick="toggleModifier('fastMode')">DISABLED</button>
                    </div>
                    <div class="modifier-card" id="mod-immortal">
                        <div class="mod-icon">üõ°Ô∏è</div>
                        <h3>IMMORTAL</h3>
                        <p>Infinite Lives.<br><span class="penalty">Coins: 33%</span></p>
                        <button class="mod-toggle" onclick="toggleModifier('immortalMode')">DISABLED</button>
                    </div>
                    <div class="modifier-card" id="mod-slow">
                        <div class="mod-icon">üêå</div>
                        <h3>SLOW MODE</h3>
                        <p>Enemies slowed.<br><span class="penalty">Coins: 50%</span></p>
                        <button class="mod-toggle" onclick="toggleModifier('slowMode')">DISABLED</button>
                    </div>
                    <div class="modifier-card" id="mod-nightmare">
                        <div class="mod-icon">üòà</div>
                        <h3>NIGHTMARE</h3>
                        <p>Enemies 2x speed.<br>Asteroids 2.5x spawn.<br><span class="bonus">Coins: 300%</span></p>
                        <button class="mod-toggle" onclick="toggleModifier('nightmareMode')">DISABLED</button>
                    </div>
                    <div class="modifier-card" id="mod-large">
                        <div class="mod-icon">üî∑</div>
                        <h3>LARGE MODE</h3>
                        <p>Ship size 2x bigger.<br>Hitbox doubled.<br><span class="bonus">Coins: 150%</span></p>
                        <button class="mod-toggle" onclick="toggleModifier('largeMode')">DISABLED</button>
                    </div>
                </div>
                <button class="game-button secondary back-button" onclick="showOverlay('start-screen'); hideOverlay('modifiers-screen')">
                    <span>‚Üê BACK TO MENU</span>
                </button>
            </div>
        </div>

        <!-- Shop Screen -->
        <div id="shop-screen" class="overlay hidden">
            <div class="overlay-content shop-content">
                <h2 class="shop-title">üõí SPACE SHOP</h2>
                <div class="shop-wallet">
                    <span>Your Coins:</span>
                    <span class="shop-coins">ü™ô <span id="shop-wallet-coins">0</span></span>
                </div>
                
                <div class="shop-tabs">
                    <button class="shop-tab active" data-tab="skins">üöÄ Ships</button>
                    <button class="shop-tab" data-tab="trails">‚ú® Trails</button>
                    <button class="shop-tab" data-tab="bullets">üí´ Bullets</button>
                    <button class="shop-tab" data-tab="backgrounds">üåå Backgrounds</button>
                </div>
                
                <div class="shop-section" id="skins-section">
                    <div class="shop-grid" id="skins-grid"></div>
                </div>
                
                <div class="shop-section hidden" id="trails-section">
                    <div class="shop-grid" id="trails-grid"></div>
                </div>
                
                <div class="shop-section hidden" id="bullets-section">
                    <div class="shop-grid" id="bullets-grid"></div>
                </div>

                <div class="shop-section hidden" id="backgrounds-section">
                    <div class="shop-grid" id="backgrounds-grid"></div>
                </div>
                
                <button id="shop-close-button" class="game-button secondary">
                    <span>‚Üê BACK TO MENU</span>
                </button>
            </div>
        </div>

        <!-- Shop Confirmation Modal -->
        <div id="shop-confirm-modal" class="overlay hidden" style="z-index: 2000;">
            <div class="overlay-content confirm-content">
                <h2 class="confirm-title">CONFIRM</h2>
                <div class="confirm-item-preview">
                     <div id="confirm-icon"></div>
                </div>
                <p id="confirm-message" class="confirm-message">Purchase this item?</p>
                <div class="confirm-price-container" id="confirm-price-box">
                     <span class="confirm-price-label">PRICE:</span>
                     <span id="confirm-price-value" class="confirm-price">ü™ô 100</span>
                </div>
                <div class="menu-buttons horizontal-buttons">
                    <button id="confirm-yes" class="game-button">CONFIRM</button>
                    <button id="confirm-no" class="game-button secondary">CANCEL</button>
                </div>
            </div>
        </div>



        <!-- Countdown Overlay -->
        <div id="countdown-overlay" class="overlay hidden" style="z-index: 2500; background: rgba(0,0,0,0.3);">
            <div class="countdown-number" id="countdown-text">3</div>
        </div>

        <!-- Pause Screen -->
        <div id="pause-screen" class="overlay hidden">
            <div class="overlay-content">
                <h2 class="pause-title">PAUSED</h2>
                <div class="menu-buttons">
                    <button id="resume-button" class="game-button">
                        <span>RESUME</span>
                        <div class="button-glow"></div>
                    </button>
                    <button id="restart-button" class="game-button secondary">
                        <span>RESTART</span>
                    </button>
                    <button id="pause-home-button" class="game-button secondary">
                        <span>Main Menu</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameover-screen" class="overlay hidden">
            <div class="overlay-content gameover-content">
                <h2 class="gameover-title">GAME OVER</h2>
                <div class="final-stats">
                    <div class="stat-row">
                        <span class="stat-label">Final Score</span>
                        <span id="final-score" class="stat-value">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Level Reached</span>
                        <span id="final-level" class="stat-value">1</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Asteroids Destroyed</span>
                        <span id="asteroids-destroyed" class="stat-value">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Cat Aliens Defeated</span>
                        <span id="aliens-destroyed" class="stat-value">0</span>
                    </div>
                    <div class="stat-row highlight">
                        <span class="stat-label">Coins Earned</span>
                        <span id="coins-earned" class="stat-value coins-earned">ü™ô 0</span>
                    </div>
                </div>
                <div id="highscore-display" class="hidden">
                    <span class="new-highscore">üèÜ NEW HIGH SCORE! üèÜ</span>
                </div>
                <div class="menu-buttons">
                    <button id="playagain-button" class="game-button">
                        <span>PLAY AGAIN</span>
                        <div class="button-glow"></div>
                    </button>
                    <button id="gameover-home-button" class="game-button secondary">
                        <span>Main Menu</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Level Up Notification -->
        <div id="levelup-notification" class="notification hidden">
            <span class="notification-text">LEVEL <span id="new-level">2</span></span>
        </div>

        <!-- Boss Wave Notification -->
        <div id="boss-notification" class="notification boss-notification hidden">
            <span class="notification-text boss-text">üê± CAT ALIENS INCOMING! üê±</span>
        </div>

        <!-- Cheat Notification -->
        <div id="cheat-warning-notification" class="notification boss-notification hidden">
            <span class="notification-text boss-text" style="font-size: 1.5rem !important;">‚ö†Ô∏è CHEAT MODE ACTIVE: NO SCORES! ‚ö†Ô∏è</span>
        </div>

        <!-- Wave Clear Notification -->
        <div id="wave-clear-notification" class="notification wave-clear-notification hidden">
            <span class="notification-text wave-clear-text">WAVE CLEARED!</span>
        </div>

        <!-- Stats Screen -->
        <div id="stats-screen" class="overlay hidden">
            <div class="overlay-content stats-content">
                <h2 class="stats-title">üìä YOUR STATS</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-highscore">0</span>
                        <span class="stat-card-label">üèÜ Best Score</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-coins">0</span>
                        <span class="stat-card-label">ü™ô Total Coins</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-games">0</span>
                        <span class="stat-card-label">üéÆ Games Played</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-asteroids">0</span>
                        <span class="stat-card-label">‚òÑÔ∏è Asteroids Destroyed</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-aliens">0</span>
                        <span class="stat-card-label">üê± Cat Aliens Defeated</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-space-pirates">0</span>
                        <span class="stat-card-label">‚ò†Ô∏è Pirates Defeated</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-jellyfish">0</span>
                        <span class="stat-card-label">ü™º Jellyfish Defeated</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="stat-total-coins">0</span>
                        <span class="stat-card-label">üí∞ Lifetime Coins</span>
                    </div>
                </div>
                <button id="stats-close-button" class="game-button secondary">
                    <span>‚Üê BACK TO MENU</span>
                </button>
            </div>
        </div>

        <!-- Settings Screen -->
        <div id="settings-screen" class="overlay hidden">
            <div class="overlay-content settings-content">
                <h2 class="settings-title">‚öôÔ∏è SETTINGS</h2>
                <div class="settings-container">
                    <div class="setting-row">
                        <span class="setting-label">üîä Master Volume</span>
                        <div class="volume-control">
                            <input type="range" id="volume-slider" min="0" max="100" value="70" class="volume-slider">
                            <span id="volume-value" class="volume-value">70%</span>
                        </div>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">üîá Mute All Sounds</span>
                        <button id="mute-toggle" class="toggle-button">
                            <span class="toggle-text" id="mute-text">OFF</span>
                        </button>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">üéµ Sound Effects</span>
                        <button id="sfx-toggle" class="toggle-button active">
                            <span class="toggle-text" id="sfx-text">ON</span>
                        </button>
                    </div>
                    <div class="setting-row desktop-only" id="control-scheme-setting">
                        <span class="setting-label">üéÆ Control Scheme</span>
                        <div class="control-scheme-selector">
                            <button id="scheme-keyboard" class="scheme-btn active" data-scheme="keyboard">
                                <span class="scheme-icon">‚å®Ô∏è</span>
                                <span class="scheme-name">Keyboard</span>
                            </button>
                            <button id="scheme-mouse" class="scheme-btn" data-scheme="mouse-aim">
                                <span class="scheme-icon">üéØ</span>
                                <span class="scheme-name">Mouse+Keys</span>
                            </button>
                            <button id="scheme-mouse-only" class="scheme-btn" data-scheme="mouse-only">
                                <span class="scheme-icon">üñ±Ô∏è</span>
                                <span class="scheme-name">Mouse Only</span>
                            </button>
                        </div>
                    </div>
                    <div class="setting-row mobile-only" id="mobile-zoom-setting">
                        <span class="setting-label">üîç Mobile FOV</span>
                        <div class="volume-control">
                            <input type="range" id="zoom-slider" min="1200" max="2400" step="100" value="1800" class="volume-slider">
                            <span id="zoom-value" class="volume-value">Medium</span>
                        </div>
                    </div>
                    
                    <!-- Account Settings (Only visible when logged in) -->
                    <div class="setting-row" id="account-settings-row" style="display:none; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px; margin-top: 15px;">
                        <span class="setting-label">üë§ Account</span>
                        <button id="delete-account-open-btn" class="game-button danger" style="font-size: 0.8rem; padding: 8px 15px; background: rgba(255, 68, 68, 0.2); border-color: #ff4444; color: #ff8888;" onclick="showDeleteAccountModal()">
                            <span>DELETE ACCOUNT</span>
                        </button>
                    </div>
                </div>
                <button id="settings-close-button" class="game-button secondary">
                    <span>‚Üê BACK TO MENU</span>
                </button>
            </div>
        </div>

        <!-- Mobile Touch Controls -->
        <div id="mobile-controls" class="mobile-controls">
            <!-- Left side: Joystick for movement -->
            <div id="joystick-container" class="joystick-container">
                <div id="joystick-base" class="joystick-base">
                    <div id="joystick-stick" class="joystick-stick"></div>
                </div>
            </div>
            <!-- Right side: Fire button -->
            <div id="fire-button-container" class="fire-button-container">
                <button id="mobile-fire-button" class="mobile-fire-button">
                    <span>üî•</span>
                    <span class="fire-label">FIRE</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="auth-modal" class="overlay auth-overlay hidden">
        <div class="auth-modal-content">
            <button class="auth-close-btn" onclick="hideAuthModal()">‚úï</button>
            
            <!-- Sign In Form -->
            <div id="signin-form" class="auth-form">
                <div class="auth-header">
                    <div class="auth-icon">üöÄ</div>
                    <h2>Welcome Back, Captain!</h2>
                    <p>Sign in to sync your progress across devices</p>
                </div>
                
                <form onsubmit="handleSignIn(event)">
                    <div class="auth-input-group">
                        <label for="signin-email">Email</label>
                        <input type="email" id="signin-email" placeholder="captain@space.com" required>
                    </div>
                    <div class="auth-input-group">
                        <label for="signin-password">Password</label>
                        <input type="password" id="signin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    
                    <button type="submit" class="auth-submit-btn">
                        <span>Sign In</span>
                    </button>
                </form>
            </div>
            
            <!-- Sign Up Form -->
            <div id="signup-form" class="auth-form" style="display: none;">
                <div class="auth-header">
                    <div class="auth-icon">‚ú®</div>
                    <h2>Join the Fleet</h2>
                    <p>Create an account to save your stats</p>
                </div>
                
                <form onsubmit="handleSignUp(event)">
                    <div class="auth-input-group">
                        <label for="signup-name">Pilot Name</label>
                        <input type="text" id="signup-name" placeholder="SpaceAce" required maxlength="15">
                    </div>
                    <div class="auth-input-group">
                        <label for="signup-email">Email</label>
                        <input type="email" id="signup-email" placeholder="captain@space.com" required>
                    </div>
                    <div class="auth-input-group">
                        <label for="signup-password">Password</label>
                        <input type="password" id="signup-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
                    </div>
                    <div class="auth-input-group">
                        <label for="signup-confirm-password">Confirm Password</label>
                        <input type="password" id="signup-confirm-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
                    </div>
                    
                    <button type="submit" class="auth-submit-btn">
                        <span>Sign Up</span>
                    </button>
                </form>
            </div>

            <!-- Reset Password Form -->
            <div id="reset-form" class="auth-form" style="display: none;">
                <div class="auth-header">
                    <div class="auth-icon">üîë</div>
                    <h2>Reset Password</h2>
                    <p>We'll send you a recovery link</p>
                </div>
                
                <form onsubmit="handlePasswordReset(event)">
                    <div class="auth-input-group">
                        <label for="reset-email">Email</label>
                        <input type="email" id="reset-email" placeholder="captain@space.com" required>
                    </div>
                    
                    <button type="submit" class="auth-submit-btn">
                        <span>Send Reset Link</span>
                    </button>
                </form>
            </div>

            <!-- Auth Error Message -->
            <div id="auth-error" class="auth-message error" style="display: none;"></div>
            
            <!-- Auth Loading -->
            <div id="auth-loading" class="auth-loading" style="display: none;">
                <div class="spinner"></div>
                <span>Connecting to Database...</span>
            </div>

            <div class="auth-footer">
                <p id="signin-footer">New recruit? <a href="#" onclick="switchAuthForm('signup')">Create Account</a></p>
                <p id="signup-footer" style="display: none;">Already have an account? <a href="#" onclick="switchAuthForm('signin')">Sign In</a></p>
                <p id="reset-footer" style="display: none;"><a href="#" onclick="switchAuthForm('signin')">Back to Sign In</a></p>
                <p id="forgot-password-link"><a href="#" onclick="switchAuthForm('reset')">Forgot Password?</a></p>
            </div>

            <div class="auth-divider">
                <span>OR</span>
            </div>

            <button type="button" class="google-btn" onclick="signInWithGoogle()">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                <span>Sign in with Google</span>
            </button>
        </div>
    </div>

    <!-- Delete Account Modal -->
    <div id="delete-account-modal" class="overlay auth-overlay hidden">
        <div class="auth-modal-content danger-theme" style="border-color: #ff4444;">
            <button class="auth-close-btn" onclick="hideDeleteAccountModal()">‚úï</button>
            <div class="auth-header">
                <div class="auth-icon">‚ö†Ô∏è</div>
                <h2 style="color: #ff4444;">Delete Account</h2>
                <p>This action is PERMANENT. All progress, coins, and items will be lost forever.</p>
            </div>
            
            <form onsubmit="handleDeleteAccount(event)">
                <div class="auth-input-group" id="delete-password-group">
                    <label for="delete-password">Confirm Password</label>
                    <input type="password" id="delete-password" placeholder="Enter your password to confirm">
                </div>
                
                <p class="auth-helper-text" id="delete-google-text" style="display:none; color: #ffaaaa; margin-bottom: 15px; font-size: 0.9rem;">
                    You will be asked to sign in with Google again to verify ownership.
                </p>
                
                <div id="delete-error" class="auth-message error" style="display: none;"></div>
                
                <div id="delete-loading" class="auth-loading" style="display: none;">
                    <div class="spinner"></div>
                    <span>Deleting Account...</span>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="auth-submit-btn secondary" onclick="hideDeleteAccountModal()">CANCEL</button>
                    <button type="submit" class="auth-submit-btn danger" style="background: linear-gradient(135deg, #cc2222 0%, #990000 100%);">DELETE FOREVER</button>
                </div>
            </form>
        </div>
    </div>                        <span>üîì Sign In</span>
                    </button>
                </form>
                
                <div class="auth-divider">
                    <span>or</span>
                </div>
                
                <button class="google-signin-btn" onclick="signInWithGoogle()">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                    <span>Continue with Google</span>
                </button>
                
                <div class="auth-footer">
                    <p>Don't have an account? <a href="#" onclick="switchAuthForm('signup'); return false;">Create one</a></p>
                    <p><a href="#" onclick="switchAuthForm('reset'); return false;">Forgot password?</a></p>
                </div>
            </div>
            
            <!-- Sign Up Form -->
            <div id="signup-form" class="auth-form" style="display: none;">
                <div class="auth-header">
                    <div class="auth-icon">‚ú®</div>
                    <h2>Join the Fleet!</h2>
                    <p>Create an account to save your progress</p>
                </div>
                
                <form onsubmit="handleSignUp(event)">
                    <div class="auth-input-group">
                        <label for="signup-name">Pilot Name</label>
                        <input type="text" id="signup-name" placeholder="Space Captain" required>
                    </div>
                    <div class="auth-input-group">
                        <label for="signup-email">Email</label>
                        <input type="email" id="signup-email" placeholder="captain@space.com" required>
                    </div>
                    <div class="auth-input-group">
                        <label for="signup-password">Password</label>
                        <input type="password" id="signup-password" placeholder="At least 6 characters" required minlength="6">
                    </div>
                    <div class="auth-input-group">
                        <label for="signup-confirm-password">Confirm Password</label>
                        <input type="password" id="signup-confirm-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    
                    <button type="submit" class="auth-submit-btn signup">
                        <span>üöÄ Create Account</span>
                    </button>
                </form>
                
                <div class="auth-divider">
                    <span>or</span>
                </div>
                
                <button class="google-signin-btn" onclick="signInWithGoogle()">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                    <span>Continue with Google</span>
                </button>
                
                <div class="auth-footer">
                    <p>Already have an account? <a href="#" onclick="switchAuthForm('signin'); return false;">Sign in</a></p>
                </div>
            </div>
            
            <!-- Password Reset Form -->
            <div id="reset-form" class="auth-form" style="display: none;">
                <div class="auth-header">
                    <div class="auth-icon">üîë</div>
                    <h2>Reset Password</h2>
                    <p>Enter your email to receive a reset link</p>
                </div>
                
                <form onsubmit="handlePasswordReset(event)">
                    <div class="auth-input-group">
                        <label for="reset-email">Email</label>
                        <input type="email" id="reset-email" placeholder="captain@space.com" required>
                    </div>
                    
                    <button type="submit" class="auth-submit-btn">
                        <span>üìß Send Reset Link</span>
                    </button>
                </form>
                
                <div class="auth-footer">
                    <p><a href="#" onclick="switchAuthForm('signin'); return false;">‚Üê Back to Sign In</a></p>
                </div>
            </div>
            
            <!-- Error/Success Message -->
            <div id="auth-error" class="auth-message" style="display: none;"></div>
            
            <!-- Loading Spinner -->
            <div id="auth-loading" class="auth-loading" style="display: none;">
                <div class="auth-spinner"></div>
                <span>Launching...</span>
            </div>
        </div>
    </div>

    <script src="firebase.js"></script>
    <script src="game.js"></script>
</body>
</html>
